const fn = require('./funcoes')
const pth = require('path');

const path = pth.join(__dirname, '..', 'dados', 'legendas')

const tokens = ['?', '_', '""', ',', '@', '<i>', '</i>', 
                '\r', '[', ']', '(', ')', '.', '♪', '-']

fn.readDirectoryAsync(path)
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//  .then(filesPath => fn.filterFilesByExtension(filesPath, '.srt'))
    .then(fn.filterFilesByExtension('.srt'))
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    .then(fn.readFilesByPathAsync)
    .then(fn.mergeContents)

//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//Separar todo o conteúdo de cada arquivo em linhas     
//  .then(contents => fn.separateBy(contents, '\n'))
    .then(fn.separateBy('\n')) 
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    .then(fn.removeBlankLines)

//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 // .then(lines => fn.removeLinesEndingWithTimeInterval(lines, '-->'))
    .then(fn.removeLinesEndingWithTimeInterval('-->'))
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    .then(fn.removeOnlyNumbers)

//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 // .then(lines => fn.removeTokens(lines, tokens))
    .then(fn.removeTokens(tokens))
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    .then(fn.mergeContents)

//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //Separar por palavras    
//  .then(lines => fn.separateBy(lines, ' '))
    .then(fn.separateBy(' ')) 
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    .then(fn.removeBlankLines)    
    .then(console.log)
    .catch(error => console.log(`Erro: ${error}`))




